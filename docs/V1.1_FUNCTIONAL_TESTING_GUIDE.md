# v1.1.0 Functional Testing Guide - Chrome DevTools Validation

**Purpose:** Validate all v1.1.0 features work correctly in real Chrome browser
**Approach:** Manual functional testing (no test files - real browser validation)
**Time Required:** 30-60 minutes for complete validation

---

## Prerequisites

‚úÖ Extension built: `/Users/nick/Desktop/hls-dash-dev-chrome-extension/dist/`
‚úÖ All code committed and pushed to origin
‚úÖ Chrome browser available

---

## Test Suite Overview

**Test Categories:**
1. URL Interception (2 tests)
2. Spec Validator Mode (5 tests)
3. HLS Validation (3 tests)
4. DASH Validation (3 tests)
5. Mode Toggle (2 tests)
6. Analysis Mode Preservation (3 tests)

**Total:** 18 functional tests

---

## SETUP: Load Extension in Chrome

### Step 1: Open Chrome Extensions Page

```
chrome://extensions
```

### Step 2: Enable Developer Mode

Toggle "Developer mode" in top-right corner

### Step 3: Load Unpacked Extension

1. Click "Load unpacked"
2. Navigate to: `/Users/nick/Desktop/hls-dash-dev-chrome-extension/dist/`
3. Click "Select"

**Expected:**
- Extension appears in list
- Name: "HLS + DASH Manifest Viewer Pro"
- Version: 1.1.0
- No errors shown

**Verify:**
- Click "service worker" link ‚Üí Console should show "Service worker loaded"
- No red errors in extension card

---

## TEST 1: .m3u8 URL Interception

### Procedure

1. In Chrome address bar, enter:
   ```
   https://devstreaming-cdn.apple.com/videos/streaming/examples/bipbop_16x9/bipbop_16x9_variant.m3u8
   ```

2. Press Enter

### Expected Behavior

**Address Bar:**
- URL should redirect to: `chrome-extension://[extension-id]/src/viewer/viewer.html#https%3A%2F%2Fdevstreaming...`

**Viewer:**
- Opens automatically (no download, no "can't display file")
- Shows Spec Validator Mode (two-panel layout)
- Left panel: Raw manifest with line numbers
- Right panel: Validation sidebar

**Console (F12):**
- Log message: `[v1.1.0] Entry point: interception, Default mode: spec`
- No JavaScript errors (red messages)

### Pass Criteria

‚úÖ Redirect happens automatically
‚úÖ Viewer displays manifest
‚úÖ Spec mode active (two-panel layout)
‚úÖ Console shows correct entry point
‚úÖ No errors in console

---

## TEST 2: .mpd URL Interception

### Procedure

Navigate to:
```
https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd
```

### Expected Behavior

Same as Test 1, but for DASH manifest

### Pass Criteria

‚úÖ .mpd URL intercepted
‚úÖ Viewer opens in Spec mode
‚úÖ DASH manifest displayed
‚úÖ Validation runs

---

## TEST 3: Spec Validator Mode Layout

**With manifest loaded from Test 1 or 2:**

### Check Left Panel (Raw Manifest)

**Expected:**
- Line numbers visible (column on left)
- Manifest text displayed (monospace font)
- Each line has hover effect (hover:bg-gray-100)
- Some lines may have colored backgrounds if errors/warnings

**Screenshot:** Full left panel

### Check Right Panel (Validation Sidebar)

**Expected Elements:**

1. **Compliance Status Badge** (top)
   - Green "‚úÖ SPEC COMPLIANT" if no errors
   - OR Red "‚ùå NON-COMPLIANT" with error count

2. **Playlist Type Badge**
   - Shows "Master Playlist" or "Media Playlist" (HLS)
   - OR "Static MPD (VOD)" or "Dynamic MPD (Live)" (DASH)
   - Blue background, description text

3. **Features Detected Section**
   - "üîç Features Detected" header
   - List of features with checkmarks
   - Example: "‚úì Independent Segments (v6+)"

4. **Validation Issues** (if any)
   - "‚ùå Errors (N)" section with red cards
   - "‚ö†Ô∏è Warnings (N)" section with yellow cards
   - Each issue shows:
     - Line number
     - Error message
     - Suggestion
     - Spec reference link

**Screenshot:** Full right panel

### Pass Criteria

‚úÖ Two-panel layout (70/30 split)
‚úÖ Line numbers visible
‚úÖ Validation badge shows
‚úÖ Playlist type identified correctly
‚úÖ Features list present
‚úÖ If errors exist, they display correctly

---

## TEST 4: HLS Validation Accuracy

### Test 4a: Compliant HLS Manifest

**Use:** bipbop_16x9_variant.m3u8 (from Test 1)

**Check in Console:**
```javascript
// Get validation results
const manifest = window.__ZUSTAND_STORE__?.getState?.().manifest;
console.log('Validation:', manifest?.validation);
```

**Expected:**
```javascript
{
  compliant: true,
  errors: [],
  warnings: [...], // may have some warnings
  playlistType: 'master',
  version: 'HLS v3' or similar,
  detectedFeatures: [...]
}
```

**Pass Criteria:**
‚úÖ compliant: true
‚úÖ errors: [] (empty array)
‚úÖ Correct playlist type detected

### Test 4b: Create Non-Compliant HLS

1. Create file `/tmp/invalid-hls.m3u8`:
   ```
   EXT-X-VERSION:6
   #EXT-X-STREAM-INF:CODECS="avc1"
   stream.m3u8
   ```
   Issues: Missing #EXTM3U, missing BANDWIDTH

2. Serve it:
   ```bash
   npx http-server /tmp -p 9999 --cors
   ```

3. Navigate to: `http://localhost:9999/invalid-hls.m3u8`

**Expected:**
- Spec mode shows
- Red "‚ùå NON-COMPLIANT" badge
- Errors section shows:
  - "EXTM3U_FIRST_LINE" error (line 1)
  - "STREAM_INF_BANDWIDTH_REQUIRED" error (line 2)
- Lines 1-2 highlighted in red

**Pass Criteria:**
‚úÖ Errors detected correctly
‚úÖ Correct line numbers
‚úÖ Lines highlighted in red
‚úÖ Error messages clear

---

## TEST 5: DASH Validation Accuracy

### Test 5a: Compliant DASH

**Navigate to:**
```
https://dash.akamaized.net/akamai/bbb_30fps/bbb_30fps.mpd
```

**Check validation in console**

**Expected:**
- compliant: true or false (depending on actual MPD)
- Correct MPD type detected (static or dynamic)
- Profile identified

### Test 5b: Invalid minBufferTime Format

1. Create `/tmp/invalid-dash.mpd`:
   ```xml
   <MPD type="static" minBufferTime="2s">
     <Period>
       <AdaptationSet mimeType="video/mp4">
         <Representation id="1" bandwidth="1000000"/>
       </AdaptationSet>
     </Period>
   </MPD>
   ```
   Issue: minBufferTime should be "PT2.0S" not "2s"

2. Navigate to: `http://localhost:9999/invalid-dash.mpd`

**Expected:**
- Error: "MIN_BUFFER_TIME_FORMAT"
- Message about ISO 8601 format
- Suggestion: "Use format PTnnn.nnnS"

**Pass Criteria:**
‚úÖ Error detected
‚úÖ Format validation works
‚úÖ Clear suggestion provided

---

## TEST 6: Mode Toggle Functionality

**Start in Spec mode (from URL interception)**

### Step 1: Switch to Analysis Mode

1. Manifest loaded in Spec mode
2. Click purple "‚Üí Deep Analysis" button in header

**Expected:**
- UI instantly changes to Analysis mode
- ViewerHeader shows view tabs (Raw/Structured/Timeline)
- Export menu appears
- Manifest data preserved (no reload)
- Console: No errors

**Verify:**
- Click "Structured" view ‚Üí Shows all 20+ analysis sections
- Click "Timeline" view ‚Üí Shows playback simulation
- All v1.0.0 features work

### Step 2: Switch Back to Spec Mode

1. Click "‚Üê Spec Validator" button

**Expected:**
- Returns to two-panel Spec layout
- Validation results still visible
- No re-fetch (data preserved)

**Pass Criteria:**
‚úÖ Toggle button visible and clickable
‚úÖ Mode switches instantly (<100ms)
‚úÖ Data preserved across toggle
‚úÖ No console errors during switch
‚úÖ Both modes fully functional

---

## TEST 7: Manual Entry Still Works (Analysis Mode Default)

### Procedure

1. Click extension icon in toolbar
2. In popup, click detected manifest OR "Open Full Viewer"
3. If "Open Full Viewer", paste URL and click Load

**Expected:**
- Opens in Analysis mode (NOT Spec mode)
- Shows v1.0.0 comprehensive layout
- Console: `[v1.1.0] Entry point: manual, Default mode: analysis`

**Pass Criteria:**
‚úÖ Manual loading opens Analysis mode
‚úÖ All analysis tools visible
‚úÖ Can toggle to Spec mode if desired

---

## TEST 8: Existing v1.0.0 Features Unchanged

### Verify in Analysis Mode

**Test each:**
1. ABR Ladder visualization - displays bitrate bars
2. Codec Analysis panel - shows codec details
3. Export menu - JSON/CSV/Text options work
4. Timeline simulation - playback simulation works
5. Quick Actions FAB - floating button appears
6. Validation Report section - shows in Structured view
7. All 20+ sections render correctly

**Pass Criteria:**
‚úÖ All existing features work
‚úÖ No regressions
‚úÖ No new bugs introduced

---

## TEST 9: Error Handling

### Test 9a: 404 URL

Navigate to:
```
https://example.com/nonexistent.m3u8
```

**Expected:**
- Shows error message
- No crash
- Console shows error (not JavaScript error)

### Test 9b: CORS Blocked

Try a URL known to block CORS (if you find one)

**Expected:**
- Shows "Network error" or CORS message
- Doesn't crash browser
- Error displayed gracefully

---

## VALIDATION CHECKLIST

**Complete when all checked:**

### URL Interception
- [ ] .m3u8 URLs redirect to viewer
- [ ] .mpd URLs redirect to viewer
- [ ] Original URL preserved in hash
- [ ] Query parameters preserved

### Spec Validator Mode
- [ ] Two-panel layout displays (70/30)
- [ ] Line numbers visible
- [ ] Validation sidebar shows
- [ ] Compliance badge correct
- [ ] Playlist type identified
- [ ] Features detected
- [ ] Errors highlight lines in red
- [ ] Warnings highlight lines in yellow

### HLS Validation
- [ ] Compliant HLS shows ‚úÖ Compliant
- [ ] Non-compliant HLS shows ‚ùå with errors
- [ ] Line numbers accurate
- [ ] Spec references present and clickable
- [ ] Suggestions helpful

### DASH Validation
- [ ] Compliant DASH shows ‚úÖ Compliant
- [ ] Non-compliant DASH shows ‚ùå with errors
- [ ] MPD structure validated
- [ ] Profile-specific rules work

### Mode Toggle
- [ ] Toggle button visible in header
- [ ] Switches between modes smoothly
- [ ] Data preserved during toggle
- [ ] No console errors on toggle
- [ ] Both modes fully functional

### Context-Aware Defaults
- [ ] URL interception ‚Üí Spec mode (default)
- [ ] Manual loading ‚Üí Analysis mode (default)
- [ ] Entry point detection accurate

### Analysis Mode Preservation
- [ ] All v1.0.0 features work
- [ ] 20+ analysis sections display
- [ ] Export functionality works
- [ ] Simulation works
- [ ] No regressions

### Build & Performance
- [ ] Extension loads without errors
- [ ] Build size acceptable (~440 KB total)
- [ ] Load time reasonable (<2s)
- [ ] No memory leaks observed
- [ ] Responsive UI (no lag)

---

## Troubleshooting

### If URL Interception Doesn't Work

**Check:**
1. Extension loaded and enabled in chrome://extensions
2. rules.json present in dist/ folder
3. declarative_net_request in manifest.json
4. Permissions granted
5. Try reloading extension (click reload icon)

**Debug:**
- Check DevTools console for errors
- Verify declarativeNetRequest rules are active
- Try clicking extension icon ‚Üí manual loading as workaround

### If Validation Doesn't Show

**Check:**
1. Console for validation errors
2. manifest.validation exists: `console.log(manifest?.validation)`
3. ValidationSidebar component rendering
4. No React errors in console

**Debug:**
- Check if validation={} is empty vs null
- Verify validator functions imported correctly
- Check console.error messages

### If Mode Toggle Doesn't Work

**Check:**
1. ViewerHeader component rendered
2. Toggle button visible
3. Click handler attached
4. viewMode state updating

**Debug:**
- Log viewMode: `console.log(window.__ZUSTAND_STORE__.getState().viewMode)`
- Try clicking multiple times
- Check for JavaScript errors

---

## Success Report Template

**After completing all tests, document:**

```markdown
# v1.1.0 Functional Testing Results

**Date:** [Date]
**Tester:** [Name]
**Browser:** Chrome [version]
**Extension Version:** 1.1.0

## Test Results

### URL Interception
- .m3u8: PASS/FAIL
- .mpd: PASS/FAIL
- Screenshots: [attached]

### Spec Validator Mode
- Layout: PASS/FAIL
- Validation display: PASS/FAIL
- Issue highlighting: PASS/FAIL

### HLS Validation
- Compliant detection: PASS/FAIL
- Error detection: PASS/FAIL
- Line numbers: PASS/FAIL

### DASH Validation
- Compliant detection: PASS/FAIL
- Error detection: PASS/FAIL
- Structure validation: PASS/FAIL

### Mode Toggle
- Switching: PASS/FAIL
- Data preservation: PASS/FAIL

### Analysis Mode
- All features: PASS/FAIL
- No regressions: PASS/FAIL

## Issues Found

[List any bugs or problems]

## Screenshots

[Attach screenshots of each mode]

## Overall Status

READY FOR RELEASE: YES/NO
```

---

## Next Steps After Testing

**If ALL tests PASS:**
1. Create v1.1.0 git tag
2. Update Chrome Web Store listing
3. Create release notes
4. Announce new features

**If tests FAIL:**
1. Document failure details
2. Debug in Chrome DevTools
3. Fix issues
4. Rebuild
5. Retest

---

**This guide ensures comprehensive functional validation of all v1.1.0 features before release.**
